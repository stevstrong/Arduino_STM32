/**
 * @file   timer_map.c
 * @author stevestrong
 * @brief  Mapping of the pins to timer device and channel.
 */


#include "timer.h"


const timer_dev * const timer_devices[] = {
NULL, TIMER1, TIMER2, TIMER3, TIMER4, TIMER6, TIMER7, TIMER8, TIMER15, TIMER16, TIMER17
};

/*
typedef struct timer_info {
    uint8_t index;    // Pin's timer device, if any.
    uint8_t channel;  // Timer channel, or 0 if none.
    uint8 af;      // alternate function. See Tables 14 and 15 from STM32F303xC device datasheet
//    uint8 dummy;
} timer_info;
*/

timer_info const timer_map[] =
{
{TIM2, 1, 1}, // PA0  | 10 | USART2_CTS, TIM2_CH1_ETR, TIM8_BKIN, TIM8_ETR, TSC_G1_IO1, COMP1_OUT  ||  ADC1_IN1, COMP1_INM, COMP7_INP, RTC_TAMP2, WKUP1
{TIM2, 2, 1}, // PA1  | 11 | USART2_RTS, TIM2_CH2, TIM15_CH1N, TSC_G1_IO2, RTC_REFIN  ||  ADC1_IN2, COMP1_INP, OPAMP1_VINP, OPAMP3_VINP
{TIM2, 3, 1}, // PA2  | 12 | USART2_TX,  TIM2_CH3, TIM15_CH1, TSC_G1_IO3, COMP2_OUT  ||  ADC1_IN3, COMP2_INM, OPAMP1_VOUT
{TIM2, 4, 1}, // PA3  | 13 | USART2_RX,  TIM2_CH4, TIM15_CH2, TSC_G1_IO4,  ||  ADC1_IN4, COMP2_INP, OPAMP1_VINP, OPAMP1_VINM
{NULL, 0, 0}, // PA4  | 14 | USART2_CK,  TIM3_CH2, SPI1_NSS, SPI3_NSS, I2S3_WS, TSC_G2_IO1  ||  ADC2_IN1, DAC1_OUT1, OPAMP4_VINP, COMP1_INM, COMP2_INM, COMP3_INM, COMP4_INM, COMP5_INM, COMP6_INM, COMP7_INM
{NULL, 0, 0}, // PA5  | 15 | SPI1_SCK,   TIM2_CH1_ETR, TSC_G2_IO2  ||  ADC2_IN2, DAC1_OUT2, OPAMP1_VINP, OPAMP2_VINM, OPAMP3_VINP, COMP1_INM, COMP2_INM, COMP3_INM, COMP4_INM, COMP5_INM, COMP6_INM, COMP7_INM
{TIM3, 1, 2}, // PA6  | 16 | SPI1_MISO,  TIM3_CH1, TIM8_BKIN, TIM1_BKIN, TIM16_CH1, COMP1_OUT, TSC_G2_IO3  ||  ADC2_IN3, OPAMP2_VOUT
{TIM3, 2, 2}, // PA7  | 17 | SPI1_MOSI,  TIM3_CH2, TIM17_CH1, TIM1_CH1N, TIM8_CH1N, TSC_G2_IO4, COMP2_OUT  ||  ADC2_IN4, COMP2_INP, OPAMP2_VINP, OPAMP1_VINP
{TIM1, 1, 6}, // PA8  | 29 | I2C2_SMBA, I2S2_MCK, USART1_CK, TIM1_CH1, TIM4_ETR, MCO, COMP3_OUT
{TIM1, 2, 6}, // PA9  | 30 | I2C2_SCL, I2S3_MCK, USART1_TX, TIM1_CH2, TIM2_CH3, TIM15_BKIN, TSC_G4_IO1, COMP5_OUT
{TIM1, 3, 6}, // PA10 | 31 | I2C2_SDA, USART1_RX, TIM1_CH3, TIM2_CH4, TIM8_BKIN, TIM17_BKIN, TSC_G4_IO2, COMP6_OUT
{TIM1, 4, 11}, // PA11 | 32 | USART1_CTS, USB_DM, CAN_RX, TIM1_CH1N, TIM1_CH4, TIM1_BKIN2, TIM4_CH1, COMP1_OUT
{TIM4, 2, 10}, // PA12 | 33 | USART1_RTS_DE, USB_DP, CAN_TX, TIM1_CH2N, TIM1_ETR, TIM4_CH2, TIM16_CH1, COMP2_OUT,
{TIM4, 3, 10}, // PA13 | 34 | USART3_CTS, TIM4_CH3, TIM16_CH1N, TSC_G4_IO3, IR_OUT, SWDIO-JTMS
{TIM8, 2, 5}, // PA14 | 37 | I2C1_SDA, USART2_TX, TIM8_CH2, TIM1_BKIN, TSC_G4_IO4, SWCLK-JTCK
{TIM8, 1, 2}, // PA15 | 38 | I2C1_SCL, SPI1_NSS, SPI3_NSS, I2S3_WS, JTDI, USART2_RX, TIM1_BKIN, TIM2_CH1_ETR, TIM8_CH1

{TIM3, 3, 2}, // PB0  | 18 | TIM3_CH3, TIM1_CH2N, TIM8_CH2N, TSC_G3_IO2  ||  ADC3_IN12, COMP4_INP, OPAMP3_VINP, OPAMP2_VINP
{TIM3, 4, 2}, // PB1  | 19 | TIM3_CH4, TIM1_CH3N, TIM8_CH3N, COMP4_OUT, TSC_G3_IO3  ||  ADC3_IN1, OPAMP3_VOUT
{NULL, 0, 0}, // PB2  | 20 | TSC_G3_IO4  ||  ADC2_IN12, COMP4_INM, OPAMP3_VINM
{NULL, 0, 0}, // PB3  | 39 | SPI3_SCK, I2S3_CK, SPI1_SCK, USART2_TX, TIM2_CH2, TIM3_ETR, TIM4_ETR, TIM8_CH1N, TSC_G5_IO1, JTDOTRACESWO,
{TIM16, 1, 1}, // PB4  | 40 | SPI3_MISO, I2S3ext_SD, SPI1_MISO, USART2_RX, TIM3_CH1, TIM16_CH1, TIM17_BKIN, TIM8_CH2N, TSC_G5_IO2, NJTRST
{TIM17, 1, 10}, // PB5  | 41 | SPI3_MOSI, SPI1_MOSI, I2S3_SD, I2C1_SMBA, USART2_CK, TIM16_BKIN, TIM3_CH2, TIM8_CH3N, TIM17_CH1
{TIM4, 1, 2}, // PB6  | 42 | I2C1_SCL, USART1_TX, TIM16_CH1N, TIM4_CH1, TIM8_CH1,TSC_G5_IO3, TIM8_ETR, TIM8_BKIN2
{TIM4, 2, 2}, // PB7  | 43 | I2C1_SDA, USART1_RX, TIM3_CH4, TIM4_CH2, TIM17_CH1N, TIM8_BKIN, TSC_G5_IO4,
{TIM4, 3, 2}, // PB8  | 45 | I2C1_SCL, CAN_RX, TIM16_CH1, TIM4_CH3, TIM8_CH2, TIM1_BKIN, TSC_SYNC, COMP1_OUT,
{TIM4, 4, 2}, // PB9  | 46 | I2C1_SDA, CAN_TX, TIM17_CH1, TIM4_CH4, TIM8_CH3, IR_OUT, COMP2_OUT
{TIM2, 3, 1}, // PB10 | 21 | USART3_TX, TIM2_CH3, TSC_SYNC  ||  COMP5_INM, OPAMP4_VINM, OPAMP3_VINM
{TIM2, 4, 1}, // PB11 | 22 | USART3_RX, TIM2_CH4, TSC_G6_IO1  ||  COMP6_INP, OPAMP4_VINP
{NULL, 0, 0}, // PB12 | 25 | SPI2_NSS, I2S2_WS, I2C2_SMBA, USART3_CK, TIM1_BKIN, TSC_G6_IO2  ||  ADC4_IN3, COMP3_INM, OPAMP4_VOUT
{NULL, 0, 0}, // PB13 | 26 | SPI2_SCK, I2S2_CK, USART3_CTS, TIM1_CH1N, TSC_G6_IO3  ||  ADC3_IN5, COMP5_INP, OPAMP4_VINP, OPAMP3_VINP
{TIM15, 1, 1}, // PB14 | 27 | SPI2_MISO, I2S2ext_SD, USART3_RTS_DE, TIM1_CH2N, TIM15_CH1, TSC_G6_IO4,  ||  COMP3_INP, ADC4_IN4, OPAMP2_VINP
{TIM15, 2, 1}, // PB15 | 28 | SPI2_MOSI, I2S2_SD, TIM1_CH3N, RTC_REFIN, TIM15_CH1N, TIM15_CH2  ||  ADC4_IN5, COMP6_INM
};
